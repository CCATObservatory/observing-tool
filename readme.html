<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
   <meta name="GENERATOR" content="Mozilla/4.72 [en] (X11; U; SunOS 5.7 sun4u) [Netscape]">
   <meta name="Author" content="Martin Folger (M.Folger@roe.ac.uk)">
   <title>Orac Java Build Notes</title>
</head>
<body>

<h2>
ORAC JAVA BUILD MANUAL</h2>

<h3>Requirements</h3>
For building and running the OT you need
<UL>
<LI><a href="http://java.sun.com">JDK - Sun's Java Development Kit</a> (version 1.3 or higher)
<LI><a href="http://java.sun.com/products/java-media/jai">JAI - Sun's Java Advanced Imaging Toolkit</a> (version 1.1 or higher)
</UL>

This readme descibes how to build/compile the OT (and OM) under Unix or Linux and how to run it under
Unix, Linux and Windows. In principle the OT can run under any platform for which you get Java.
Unix, Linux and Windows are the ones for which we supply scripts containg all the information needed
by Java to start up the OT.

If you put the above Java into your into <tt>PATH</tt> then compiling and running the OT as descibed below will not require
any changes to any configuration files.

<h3>Building and running the OT</h3>
This compiles the OT java code and runs the OT using the *.class files in <tt>MyBuildDir</tt>.
<p>
<b>Solaris/Linux</b>
<blockquote><pre>
cd MyBuildDir
cvs export -D "`date`" orac3      <i>Alternatively</i>: cvs co orac3  (<i>Or simply get a copy of</i> orac3.)
cd orac3
gmake
OT/bin/ot [-h] [-[no]internalframes] [-[no]omp] ukirt|jcmt &amp;
</pre></blockquote>

<b>Windows</b> (after compiling/building under Solaris or Linux, see above)
<blockquote><pre>
cd MyBuildDir/orac3/OT/bin
ot.bat [-h] [-[no]internalframes] [-[no]omp] ukirt|jcmt
</pre>
(Double mouse click should work as well if you are happy with the default options/telescope.)
</blockquote>

<h3>Installing the OT</h3>
This bundles the *.class files in <tt>MyBuildDir</tt> into jar files in <tt>MyInstallDir/lib</tt>.
Other resources scripts are also created in/copied to <tt>MyInstallDir</tt>.
<p>
<b>Solaris/Linux</b>
<blockquote><pre>
cd MyBuildDir/orac3
gmake INSTALL_ROOT=MyInstallDir install
MyInstallDir/bin/ot [-h] [-[no]internalframes] ukirt|jcmt &amp;
</pre></blockquote>

<b>Windows</b> (after compiling/building and installing under Solaris or Linux, see above)
<blockquote><pre>
cd MyInstallDir/bin
ot.bat [-h] [-[no]internalframes] [-[no]omp] ukirt|jcmt
</pre>
(Double mouse click should work as well if you are happy with the default options/telescope.)
</blockquote>

If no INSTALL_ROOT is specified then the directory <tt>MyBuildDir/orac3/install</tt> is used.
<p>
<tt>MyInstallDir</tt> is self-contained and can be copied to other locations. The only outside
thing it relies on is an installation of Java. By default the OT uses the java in your PATH
unless you changed the configuration files.
<p>
<b>The remainder of this readme document should rarely be needed in order to build (and install) and run the OT.
It contains information for the expert user some of which might by outdated.</b>

<p><hr><hr><hr><p>

<h3>Troubleshooting</h3>
<ul>
<li>
Note that the configuration directory that used to be called <tt>cfg/</tt>
is now called <tt> cfg/ukirt/ </tt> or <tt> cfg/jcmt/ </tt> etc. E.g. <tt>-Dot.cfgdir=some_directory/cfg/</tt>
in the script is now&nbsp; <tt>-Dot.cfgdir=some_directory/cfg/ukirt/</tt></li><p>

<li>
<b>Telescope configuration directory &lt;TELESCOPE&gt; not found in &lt;LOCAL_INSTALL_ROOT&gt;/cfg</b><br>
(The following does not refer to scripts created by "gmake install")<br>
The Unix/Linux script for starting up the OT (&lt;LOCAL_INSTALL_ROOT&gt;/bin/ot) contain absolute path names
of directories specified in OT/conf/make.conf.
The variables in the scripts are generated by <TT>gmake</TT> using <TT>pwd</TT>. If these path names differ from the ones on the
machine you are running the OT on then the above problem occurs.<p>

<b>Example:</b><br>
Building the OT on your main server might have resulted in the following line in the script (&lt;LOCAL_INSTALL_ROOT&gt;/bin/ot)
<pre>
set CFG_DIRS = /data/orac3/OT/install/cfg
</pre>
But in order to be able to run this on other machines you might want it be.
<pre>
    set CFG_DIRS = /net/&lt;main_server&gt;/data/orac3/OT/install/cfg
</pre>
<b>Solution:</b><br>
<pre>
    slogin &lt;machine_where_you_want_to_run_the_OT&gt;
    cd orac3/OT/src
    rm &lt;LOCAL_INSTALL_ROOT&gt;/bin/ot                   (by default: rm ../install/bin/ot)
    gmake
    &lt;LOCAL_INSTALL_ROOT&gt;/bin/ot ukirt | jcmt         (by default: ../install/bin/ot ukirt | jcmt)
</pre>
</ul>

<p>The following notes and examples refer to the default settings as defined
in the unchanged make.conf files. The directories defined in these make.conf
can be changed by users to fit their local requirements.
<p>The orac java code has been divided into 7 modules: EDFREQ, GEMINI, ORAC, ODB,
OT, OM and OMP which are located in
<p><tt>MyBuildDir/orac3/EDFREQ</tt>
<p><tt>MyBuildDir/orac3/GEMINI</tt>
<br><tt>MyBuildDir/orac3/ORAC</tt>
<br><tt>MyBuildDir/orac3/ODB</tt>
<br><tt>MyBuildDir/orac3/OT</tt>
<br><tt>MyBuildDir/orac3/OM</tt>
<br><tt>MyBuildDir/orac3/OMP</tt>
<p>(These files are in MyBuildDir/orac3)
<p><b><u>Configuration files:</u></b>
<p><tt>MyBuildDir/orac3/conf/make.conf</tt>
<p><tt>MyBuildDir/orac3/EDFREQ/conf/make.conf</tt>
<p><tt>MyBuildDir/orac3/GEMINI/conf/make.conf</tt>
<br><tt>MyBuildDir/orac3/ORAC/conf/make.conf</tt>
<br><tt>MyBuildDir/orac3/ODB/conf/make.conf</tt>
<br><tt>MyBuildDir/orac3/OT/conf/make.conf</tt>
<br><tt>MyBuildDir/orac3/OM/conf/make.conf</tt>
<br><tt>MyBuildDir/orac3/OMP/conf/make.conf</tt>
<br>&nbsp;
<p><b>Note: Unless the classpath variables in the respective make.conf
files are set according to local locations of the classes/jar files you
will have to check out/export the whole orac3 directory from cvs as the
default classpath settings assume this directory structure.</b>
<br>&nbsp;
<p><b><u>COMPILE, JAR, DOC OF MODULES</u></b>
<p><tt>cd &lt;MODULE>/src&nbsp;&nbsp;&nbsp; </tt>(where &lt;MODULE> is
GEMINI | ORAC | ODB | OT | OM)
<br>&nbsp;
<p><tt>Making</tt>
<br><tt>&nbsp;&nbsp;&nbsp; class files&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
:&nbsp; "gmake"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (output:
CLASSES_DIR, set in CONF_HOME/make.conf)</tt>
<br><tt>&nbsp;&nbsp;&nbsp; jar file with classes:&nbsp; "gmake jar"&nbsp;&nbsp;&nbsp;&nbsp;
(output: JAR_DIR,&nbsp;&nbsp;&nbsp;&nbsp; set in CONF_HOME/make.conf)</tt>
<br><tt>&nbsp;&nbsp;&nbsp; javadoc html files&nbsp;&nbsp; :&nbsp; "gmake
doc"&nbsp;&nbsp;&nbsp;&nbsp; (output: DOC_DIR,&nbsp;&nbsp;&nbsp;&nbsp;
set in CONF_HOME/make.conf)</tt>
<br><tt>&nbsp;&nbsp;&nbsp; install&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
:&nbsp; "gmake install" (output: see CONF_HOME/make.conf)</tt>
<br><tt>&nbsp;&nbsp;&nbsp; clean&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; :&nbsp; "gmake
clean"&nbsp;&nbsp; (deletes class files, jar files, api docs)</tt>
<p>The output directories are by default sub directories of<tt> LOCAL_INSTALL_ROOT
(&lt;MODULE>/install).</tt>
<br>They can be edited in <tt>CONF_HOME/make.conf</tt> or changed on the
command line. E.g. "<tt>gmake JAR_DIR=my_jar_dir jar</tt>"
<br>creates a jar file of the module in<tt> my_jar_dir.</tt>
<p><b>Note: For the modules OT and OM "gmake" will also create a script
OT/bin/ot (OM/bin/ot) that can be used to run the OT (OM).</b>
<br><b>It uses the settings specified in the OT/conf/make.conf (OM/conf/make.conf)</b>
<br>&nbsp;
<br>&nbsp;
<p><b><tt><u>INSTALLING OT and OM</u></tt></b>
<p><tt>gmake install </tt>can be used to bundle up
<ul>
<li>
OT (OM) application</li>

<li>
cfg files</li>

<li>
resources (images etc)</li>

<li>
the shared classes (GEMINI, ORAC, ODB)</li>

<li>
all third party libraries</li>

<li>
a script for running the OT</li>
</ul>
in one directory (INSTALL_ROOT)
<p>Currently "gmake install" does not create the api docs. Use "<tt>gmake
DOC_DIR=my_doc_dir doc</tt>" instead.
<p>Make sure the variable <tt>INSTALL_ROOT</tt> is set to the directory
where you want the software to be installed. Set <tt>INSTALL_ROOT</tt>
in the O<tt>T/conf/make.conf (OM/conf/make.conf) </tt>or on the command
line: <tt>gmake INSTALL_ROOT=MyInstallDir install.</tt>
<br>&nbsp;
<p><tt>[cd MyBuildDir/orac3</tt>
<br><tt>&nbsp;gmake]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</tt>(compiles all the modules, optional but recommended if other modules
have not been compiled yet,
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</tt>otherwise all the compiling would have to be done during gmake install.)<tt></tt>
<p><tt>cd MyBuildDir/orac3/OT/src&nbsp;&nbsp; </tt>or<tt>&nbsp;&nbsp;
cd MyBuildDir/orac3/OM/src</tt>
<br><tt>gmake [INSTALL_ROOT=MyInstallDir] install</tt>
<br>&nbsp;
<br>&nbsp;<b><u></u></b>
<p><b><u>COMPILING EVERYTHING IN ONE GO</u></b>
<p>"<tt>gmake</tt>" can also be called in <tt>MyBuildDir/orac3:</tt>
<p><tt>cd MyBuildDir/orac3</tt>
<br><tt>gmake</tt>
<br><tt></tt>&nbsp;<tt></tt>
<p><b><tt><u>GETTING API JAVA DOCS FOR&nbsp;ALL JAVA CLASSES</u></tt></b><tt></tt>
<p><tt>cd MyBuildDir/orac3</tt>
<br><tt>gmake [DOC_DIR=my_doc_dir] doc</tt><tt></tt>
<p>
</body>
</html>
